SELECT 
	U.Id,
	U.gender,
	CASE 
		WHEN DATEDIFF(YY,U.birthDate,GETDATE()) < 18 THEN 'Under 18'
		WHEN DATEDIFF(YY,U.birthDate,GETDATE()) >= 18 AND DATEDIFF(YY,U.birthDate,GETDATE()) < 27 THEN '18 to 27'
		WHEN DATEDIFF(YY,U.birthDate,GETDATE()) >= 27 AND DATEDIFF(YY,U.birthDate,GETDATE()) < 40 THEN '27 to 40'
		WHEN DATEDIFF(YY,U.birthDate,GETDATE()) >= 40 AND DATEDIFF(YY,U.birthDate,GETDATE()) < 55 THEN '40 to 55'
		WHEN DATEDIFF(YY,U.birthDate,GETDATE()) >= 55 THEN 'Over 55'
		ELSE NULL END AS AGE_BRACKET
INTO #BRACKETS
FROM
	<OurActualDatabaseName>.dbo.[User] U 
WHERE
	U.birthDate IS NOT NULL
;

SELECT 
	B.AGE_BRACKET,
	COUNT(B.Id) AS NUM_PEOPLE
FROM 
	#BRACKETS B
WHERE
	B.GENDER IN ('M','F','O')

GROUP BY
	B.AGE_BRACKET
;
DROP TABLE #BRACKETS;
